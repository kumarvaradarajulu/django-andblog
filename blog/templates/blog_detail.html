{% extends "base.html" %}
{% load static crispy_forms_tags thumbnail %}
{% load url from future %}
{% load disqus_tags %}
{% disqus_dev %}

{% block extra_js %}
    {{ form.media }}
{% endblock extra_js %}


{% block main %}
    {% with article.articlesection_set.all as sections %}
        <article class="post" id="{{ article.id }}">
            {% for section in sections %}
                <section class="pure-u-1 s" id="section_{{ section.section_order }}">
                    {% if forloop.first %}
                        <header>
                            <h1 class="s-t">{{ section.title }}</h1>
                            {% include "includes/post_meta.html" %}
                        </header>
                        {% thumbnail article.image "1280x480" crop="top" as im %}
                            <img src="{{ im.url }}" class="pure-img">
                        {% endthumbnail %}

                        {% with "show" as display %}
                            {% include "includes/section_summary.html" %}
                        {% endwith %}
                    {% else %}
                        <header>
                            <h2 class="s-t">{{ section.title }}</h2>
                        </header>
                    {% endif %}
                    <div class="s-d">
                        <p>{{ section.content|safe }}</p>
                    </div>
                    <footer>
                        <div class="l-u-b" id="{{ section.id }}">
                            <!-- likes inlikes wrapper -->
                            <span class="likes">{{ section.likes }}</span>
                            <span class="unlikes">{{ section.unlikes }}</span>
                            <span class="like" data-type="1">Like</span>
                            <span class="unlike" data-type="0">UnLike</span>
                            <span class="abusive" data-type="9">Report Abusive</span>
                        </div>
                    </footer>
                </section>
            {% endfor %}
        </article>
        {% disqus_show_comments %}
    {% endwith %}
{% endblock main %}
